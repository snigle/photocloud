__d(function(g,r,i,a,m,e,d){m.exports=r(d[0])},3060,[3062]);
__d(function(g,r,i,a,m,e,d){'use strict';var t=r(d[0]);e.EventStreamSerde=class{constructor({marshaller:t,serializer:n,deserializer:s,serdeContext:o,defaultContentType:l}){this.marshaller=t,this.serializer=n,this.deserializer=s,this.serdeContext=o,this.defaultContentType=l}async serializeEventStream({eventStream:t,requestSchema:n,initialRequest:s}){const o=this.marshaller,l=n.getEventStreamMember(),c=n.getMemberSchema(l),y=this.serializer,u=this.defaultContentType,h=Symbol("initialRequestMarker"),f={async*[Symbol.asyncIterator](){if(s){const t={":event-type":{type:"string",value:"initial-request"},":message-type":{type:"string",value:"event"},":content-type":{type:"string",value:u}};y.write(n,s);const o=y.flush();yield{[h]:!0,headers:t,body:o}}for await(const n of t)yield n}};return o.serialize(f,t=>{if(t[h])return{headers:t.headers,body:t.body};const n=Object.keys(t).find(t=>"__type"!==t)??"",{additionalHeaders:s,body:o,eventType:l,explicitPayloadContentType:y}=this.writeEventBody(n,c,t);return{headers:Object.assign({":event-type":{type:"string",value:l},":message-type":{type:"string",value:"event"},":content-type":{type:"string",value:y??u}},s),body:o}})}async deserializeEventStream({response:n,responseSchema:s,initialResponseContainer:o}){const l=this.marshaller,c=s.getEventStreamMember(),y=s.getMemberSchema(c).getMemberSchemas(),u=Symbol("initialResponseMarker"),h=l.deserialize(n.body,async n=>{const o=Object.keys(n).find(t=>"__type"!==t)??"",l=n[o].body;if("initial-response"===o){const t=await this.deserializer.read(s,l);return delete t[c],Object.assign({[u]:!0},t)}if(o in y){const s=y[o];if(s.isStructSchema()){const c={};let y=!1;for(const[u,h]of s.structIterator()){const{eventHeader:s,eventPayload:f}=h.getMergedTraits();if(y=y||Boolean(s||f),f)h.isBlobSchema()?c[u]=l:h.isStringSchema()?c[u]=(this.serdeContext?.utf8Encoder??t.toUtf8)(l):h.isStructSchema()&&(c[u]=await this.deserializer.read(h,l));else if(s){const t=n[o].headers[u]?.value;null!=t&&(h.isNumericSchema()?c[u]=t&&"object"==typeof t&&"bytes"in t?BigInt(t.toString()):Number(t):c[u]=t)}}if(y)return{[o]:c};if(0===l.byteLength)return{[o]:{}}}return{[o]:await this.deserializer.read(s,l)}}return{$unknown:n}}),f=h[Symbol.asyncIterator](),p=await f.next();if(p.done)return h;if(p.value?.[u]){if(!s)throw new Error("@smithy::core/protocols - initial-response event encountered in event stream but no response schema given.");for(const[t,n]of Object.entries(p.value))o[t]=n}return{async*[Symbol.asyncIterator](){for(p?.value?.[u]||(yield p.value);;){const{done:t,value:n}=await f.next();if(t)break;yield n}}}}writeEventBody(n,s,o){const l=this.serializer;let c,y=n,u=null;const h={};if(s.getSchema()[4].includes(n)){const t=s.getMemberSchema(n);if(t.isStructSchema()){for(const[s,l]of t.structIterator()){const{eventHeader:t,eventPayload:c}=l.getMergedTraits();if(c)u=s;else if(t){const t=o[n][s];let c="binary";l.isNumericSchema()?c=-2147483648<=t&&t<=2147483647?"integer":"long":l.isTimestampSchema()?c="timestamp":l.isStringSchema()?c="string":l.isBooleanSchema()&&(c="boolean"),null!=t&&(h[s]={type:c,value:t},delete o[n][s])}}if(null!==u){const s=t.getMemberSchema(u);s.isBlobSchema()?c="application/octet-stream":s.isStringSchema()&&(c="text/plain"),l.write(s,o[n][u])}else l.write(t,o[n])}else{if(!t.isUnitSchema())throw new Error("@smithy/core/event-streams - non-struct member not supported in event stream union.");l.write(t,{})}}else{const[t,s]=o[n];y=t,l.write(15,s)}const f=l.flush();return{body:"string"==typeof f?(this.serdeContext?.utf8Decoder??t.fromUtf8)(f):f,eventType:y,explicitPayloadContentType:c,additionalHeaders:h}}}},3062,[2441]);